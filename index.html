<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ GameBoy Birthday Gift</title>
    <style>
        /* ===== RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, #1a1a2e, #16213e, #0f3460);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        #gameboy-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ===== SCREEN TRANSITIONS ===== */
        .screen {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
        }

        .screen.active {
            display: flex !important;
            opacity: 1;
            transform: translateY(0);
        }

        /* ===== LOADING SCREEN ===== */
        #loading-screen .gameboy-screen {
            width: 600px;
            height: 400px;
            background: #000;
            border: 4px solid #00ff00;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #loading-screen .screen-content {
            text-align: center;
            width: 100%;
            padding: 40px;
        }

        #loading-screen .title {
            font-size: 48px;
            font-weight: bold;
            color: #00ff00;
            margin-bottom: 40px;
            letter-spacing: 4px;
            animation: glow 1.5s infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px #00ff00; }
            to { text-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00; }
        }

        #loading-screen .loading-text {
            font-size: 24px;
            color: #00ff00;
            margin-bottom: 30px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { opacity: 0.5; }
        }

        .progress-bar {
            width: 80%;
            height: 30px;
            background: #333;
            border: 2px solid #00ff00;
            margin: 0 auto;
            position: relative;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #00ff00;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000;
            font-weight: bold;
            font-size: 16px;
            z-index: 2;
        }

        /* ===== MAIN GAMEBOY ===== */
        .gameboy-body {
            width: 400px;
            height: 600px;
            background: linear-gradient(145deg, #e8e8e8, #d0d0d0);
            border-radius: 20px 20px 40px 40px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.8);
            position: relative;
        }

        .gameboy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 12px;
            color: #666;
        }

        .power-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .power-dot {
            width: 8px;
            height: 8px;
            background: #ff4444;
            border-radius: 50%;
            animation: powerBlink 2s infinite;
        }

        @keyframes powerBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .brand-text {
            font-weight: bold;
            font-size: 14px;
        }

        .gameboy-screen {
            width: 100%;
            height: 200px;
            background: #2d5016;
            border: 8px solid #1a1a1a;
            border-radius: 8px;
            margin-bottom: 20px;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }

        .gameboy-screen .screen-content {
            padding: 20px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .birthday-title {
            color: #9bbc0f;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #9bbc0f;
        }

        .start-text {
            color: #ffff00;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .screen-info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            justify-content: space-between;
            font-size: 8px;
            color: #666;
        }

        .battery {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .battery-dot {
            width: 4px;
            height: 4px;
            background: #ff4444;
            border-radius: 50%;
        }

        /* ===== MENU BUTTONS ===== */
        .menu-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 30px;
        }

        .menu-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            text-transform: uppercase;
            color: white;
        }

        .menu-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .message-btn { background: linear-gradient(145deg, #4a90e2, #357abd); }
        .gallery-btn { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        .music-btn { background: linear-gradient(145deg, #9b59b6, #8e44ad); }
        .tetris-btn { background: linear-gradient(145deg, #27ae60, #229954); }

        /* ===== CONTROLS ===== */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .dpad {
            width: 100px;
            height: 100px;
            position: relative;
        }

        .dpad-center {
            width: 100%;
            height: 100%;
            background: #333;
            position: relative;
            border-radius: 50%;
        }

        .dpad-center div {
            position: absolute;
            background: #555;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            cursor: default;
        }

        .dpad-up, .dpad-down {
            width: 40px;
            height: 30px;
            left: 50%;
            transform: translateX(-50%);
        }

        .dpad-up { top: 5px; border-radius: 8px 8px 0 0; }
        .dpad-down { bottom: 5px; border-radius: 0 0 8px 8px; }
        .dpad-left, .dpad-right {
            width: 30px;
            height: 40px;
            top: 50%;
            transform: translateY(-50%);
        }

        .dpad-left { left: 5px; border-radius: 8px 0 0 8px; }
        .dpad-right { right: 5px; border-radius: 0 8px 8px 0; }

        .action-buttons {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            font-weight: bold;
            font-size: 20px;
            cursor: pointer;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .action-btn:hover {
            transform: translateY(-2px);
        }

        /* ===== BOTTOM CONTROLS ===== */
        .bottom-controls {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .control-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            background: #666;
            color: white;
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
        }

        .control-btn:hover {
            background: #777;
            transform: translateY(-1px);
        }

        .speaker-grille {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at 25% 25%, #333 2px, transparent 2px),
                        radial-gradient(circle at 75% 25%, #333 2px, transparent 2px),
                        radial-gradient(circle at 25% 75%, #333 2px, transparent 2px),
                        radial-gradient(circle at 75% 75%, #333 2px, transparent 2px);
            background-size: 8px 8px;
        }

        /* ===== PAGE CONTAINER ===== */
        .page-container {
            width: 400px;
            height: 600px;
            background: linear-gradient(145deg, #7b68ee, #6a5acd);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 4px solid #ffd700;
            display: flex;
            flex-direction: column;
        }

        .page-screen {
            flex: 1;
            background: #2d5016;
            border: 4px solid #1a1a1a;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .page-header {
            background: #1a1a1a;
            color: #9bbc0f;
            padding: 10px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
        }

        .page-controls {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .page-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            background: #4a90e2;
            color: white;
        }

        .page-btn:hover {
            transform: translateY(-2px);
        }

        /* ===== MESSAGE SCREEN ===== */
        .message-content {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            color: #9bbc0f;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .skip-btn {
            margin: 10px auto;
            padding: 6px 12px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            width: fit-content;
        }

        .skip-btn:hover {
            background: #c0392b;
        }

        /* ===== GALLERY ===== */
        .gallery-content {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .photobox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #666;
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .photobox-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .photobox-dot.red { background: #ff4444; }
        .photobox-dot.green { background: #44ff44; }

        .photobox-title {
            color: #ffff00;
            font-size: 12px;
            font-weight: bold;
        }

        .photobox-progress {
            background: #333;
            border-radius: 4px;
            margin-bottom: 15px;
            padding: 8px;
            color: #9bbc0f;
            font-size: 11px;
            text-align: center;
        }

        .photo-display {
            background: #1a1a2e;
            border-radius: 8px;
            padding: 15px;
            min-height: 200px;
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .photo-frame {
            background: #f0f0f0;
            border: 3px solid #333;
            border-radius: 6px;
            height: 100px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .photo-frame.filled {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .photo-btn {
            padding: 10px 20px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            width: 100%;
        }

        .photo-btn:hover:not(:disabled) {
            background: #c0392b;
        }

        .photo-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }

        /* ===== MUSIC ===== */
        .music-content {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }

        .playlist {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .song {
            padding: 10px;
            margin-bottom: 5px;
            background: #1a1a2e;
            color: #9bbc0f;
            border-radius: 4px;
            cursor: pointer;
        }

        .song:hover {
            background: #2a2a4e;
        }

        .song.playing {
            background: #4a90e2;
            color: white;
            font-weight: bold;
        }

        .music-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }

        .music-controls button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: #4a90e2;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .music-controls button:hover {
            transform: scale(1.1);
        }

        .now-playing {
            text-align: center;
            color: #9bbc0f;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="gameboy-container">
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen active">
            <div class="gameboy-screen">
                <div class="screen-content">
                    <h1 class="title">BIRTHDAY GIFT</h1>
                    <div class="loading-text" id="loading-text">&gt; INITIALIZING..._</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                        <div class="progress-text" id="progress-text">0%</div>
                    </div>
                </div>
            </div>
    </div>
        <!-- Main Screen -->
    <div id="main-screen" class="screen">
        <div class="gameboy-body">
            <div class="gameboy-header">
                <div class="power-indicator">
                    <span class="power-dot"></span>
                    <span class="power-text">POWER</span>
                </div>
                <div class="brand-text">GAME-BOY</div>
            </div>
            
            <div class="gameboy-screen">
                <div class="screen-content">
                    <h1 class="birthday-title">Happy Birthday!</h1>
                    <div class="start-text">Press START</div>
                    <div class="screen-info">
                        <span class="dot-matrix">DOT MATRIX WITH STEREO SOUND</span>
                        <span class="battery">
                            <span class="battery-dot"></span>
                            BATTERY
                        </span>
                    </div>
                </div>
            </div>

            <div class="menu-buttons">
                <button class="menu-btn message-btn" onclick="showScreen('message')">MESSAGE</button>
                <button class="menu-btn gallery-btn" onclick="showScreen('gallery')">GALLERY</button>
                <button class="menu-btn music-btn" onclick="showScreen('music')">MUSIC</button>
                <button class="menu-btn tetris-btn" onclick="showScreen('tetris')">TETRIS</button>
            </div>

            <div class="controls">
                <div class="dpad">
                    <div class="dpad-center">
                        <div class="dpad-up">‚Üë</div>
                        <div class="dpad-left">‚Üê</div>
                        <div class="dpad-right">‚Üí</div>
                        <div class="dpad-down">‚Üì</div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="action-btn b-btn">B</button>
                    <button class="action-btn a-btn">A</button>
                </div>
            </div>

            <div class="bottom-controls">
                <button class="control-btn select-btn">SELECT</button>
                <button class="control-btn start-btn" onclick="showScreen('main')">START</button>
            </div>

            <div class="speaker-grille"></div>
        </div>
    </div>

    <!-- Message Screen -->
    <div id="message-screen" class="screen">
        <div class="page-container">
            <div class="page-screen">
                <div class="page-header">üìù MESSAGE</div>
                <div class="message-content" id="message-content"></div>
                <button class="skip-btn" id="skip-btn">SKIP</button>
            </div>
            <div class="page-controls">
                <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
            </div>
        </div>
    </div>

    <!-- Gallery Screen -->
    <div id="gallery-screen" class="screen">
        <div class="page-container">
            <div class="page-screen">
                <div class="page-header">üñºÔ∏è GALLERY</div>
                <div class="gallery-content">
                    <div class="photobox-header">
                        <div class="photobox-dot red"></div>
                        <span class="photobox-title">PHOTOBOX</span>
                        <div class="photobox-dot green"></div>
                    </div>
                    <div class="photobox-progress" id="photobox-progress">üì∏ READY TO PRINT</div>
                    <div class="photo-display" id="photo-display">
                        <div class="photo-placeholder">Press START PRINT to begin</div>
                    </div>
                    <div class="photobox-controls">
                        <button class="photo-btn" id="photo-btn">START PRINT</button>
                    </div>
                </div>
            </div>
            <div class="page-controls">
                <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
            </div>
        </div>
    </div>

    <!-- Music Screen -->
    <div id="music-screen" class="screen">
        <div class="page-container">
            <div class="page-screen">
                <div class="page-header">üéµ MUSIC</div>
                <div class="music-content">
                    <div class="playlist">
                        <div class="song" data-index="0">üéµ 1. Happy Birthday</div>
                        <div class="song" data-index="1">üéµ 2. My Love Mine All Mine - Mitski</div>
                        <div class="song" data-index="2">üéµ 3. Line Without a Hook - Ricky Montgomery</div>
                        <div class="song" data-index="3">üéµ 4. 505 - Arctic Monkeys</div>
                        <div class="song" data-index="4">üéµ 5. RUDE! - Hearts2Hearts</div>
                    </div>
                    <div class="music-controls">
                        <button id="prev-btn">‚èÆ</button>
                        <button id="play-pause-btn">‚èØ</button>
                        <button id="next-btn">‚è≠</button>
                    </div>
                    <div class="now-playing" id="now-playing">üéú Not Playing</div>
                </div>
            </div>
            <div class="page-controls">
                <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
            </div>
        </div>
    </div>

    <!-- Tetris Screen -->
    <div id="tetris-screen" class="screen">
        <div class="page-container">
            <div class="page-screen">
                <div class="tetris-header">
                    <div class="tetris-title">üéÆ TETRIS</div>
                    <div class="tetris-stats">
                        <div class="stat">Score: <span id="score">0</span></div>
                        <div class="stat">Level: <span id="level">1</span></div>
                        <div class="stat">Lines: <span id="lines">0</span></div>
                    </div>
                </div>
                <div class="tetris-game">
                    <canvas id="tetris-canvas" width="300" height="400"></canvas>
                </div>
                <div class="tetris-controls">
                    <button class="tetris-btn" id="left-btn">‚óÄ</button>
                    <button class="tetris-btn" id="rotate-btn">‚Üª ROTATE</button>
                    <button class="tetris-btn" id="right-btn">‚ñ∂</button>
                </div>
            </div>
            <div class="page-controls">
                <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="game-over-modal" class="modal">
        <div class="modal-content">
            <div class="game-over-text">GAME OVER</div>
            <button class="modal-btn" id="game-over-ok">OK</button>
        </div>
    </div>

    <!-- Final Message Modal -->
    <div id="final-message-modal" class="modal">
        <div class="modal-content">
            <div class="final-message-title">üéÇ HAPPY BIRTHDAY! üéÇ</div>
            <div class="final-message-text">
                <p>Even if you lose in the game,</p>
                <p>you always win in my heart!</p>
                <p class="love-text">I LOVE YOU TWIN üíï</p>
            </div>
            <button class="modal-btn" id="final-ok">OK</button>
        </div>
    </div>
                </div>
                    <script>
        // Game state
        let currentScreen = 'loading';
        let tetrisGame = null;
        let gameScore = 0;
        let gameLevel = 1;
        let gameLines = 0;
        let typewriterInterval = null;
        let isTyping = false;
        let currentPhotoIndex = 0;
        let currentSongIndex = 0;
        let isPlaying = false;
        let gameOverTimer = null;

        // Message
        const fullMessage = `Hi, Miyu ‚Äî or as I often call you, Mango.

I suddenly realized: we've come this far together, and I don't think I've ever thanked you properly.

Thank you for being such a... weird TWIN.
In the most positive way possible.

You're so kind. Sometimes I think, "How can Mango be this patient with me?"
Patient ‚Äî even though I know I sometimes annoy you with the same old antics.

You're also loud. Super loud.
When we hang out, there's never a dull moment. Your voice is like the most comforting background noise in my life.
Chatty, talkative, love to nag. But somehow, when I don't hear your voice, something feels missing.

Caring. So much.
Down to the little things others don't notice.
You always know when to send a message, when to show up, when to just sit beside me in silence.

Attentive. Sometimes it makes me think, "Wow, Mango really looks out for me."
You're beautiful ‚Äî that's a fact.
But what makes you different isn't just your looks, but the way you see the world: always finding room to laugh, even in the hardest times.

Funny, humorous, love to joke.
You're the type of person who can make people mad, but also make them forget why they were angry.
Because beneath all your randomness, there's a heart that's incredibly sincere.

You don't dwell on things ‚Äî that's what I admire most.
You're the type who says, "Problem? Okay, next." Not because you don't feel, but because you choose not to drown. And that's really cool.

Most importantly: you always make my day colorful.
Even on the grayest days, you show up ‚Äî through chats, through stories, through your random antics ‚Äî and everything becomes a little brighter.

Thank you for being a place to come home to, a place to share stories, a place to laugh, a place to cry, and a place to just be myself without fear of judgment.

Thank you for choosing to be my TWIN, out of thousands of people.

I love you, Mango ‚Äî as a TWIN.
Never change.
Keep being you ‚Äî annoying, loud, funny, caring, and always making life a little less quiet.

‚Äî From someone who's always proud of you,  
ItsZio & Uncle Vic üíï`;

        // Photos WITH IMAGE PATHS
        const photos = [
            { text: 'TWIN MEMORY TRIO üéÆ', image: './images/photo1.jpg' },
            { text: 'TWIN MEMORY TRIO üéÇ', image: './images/photo2.jpg' },
            { text: 'TWIN MEMORY TRIO ü§™', image: './images/photo3.jpg' },
            { text: 'TWIN MEMORY TRIO üí™', image: './images/photo4.jpg' },
            { text: 'TWIN MEMORY TRIO üòÇ', image: './images/photo5.jpg' },
            { text: 'TWIN MEMORY TRIO üåà', image: './images/photo6.jpg' },
            { text: 'TWIN MEMORY TRIO üéâ', image: './images/photo7.jpg' },
            { text: 'TWIN MEMORY TRIO üôè', image: './images/photo8.jpg' }
        ];

        // Song titles
        const songTitles = [
            'Happy Birthday',
            'My Love Mine All Mine - Mitski',
            'Line Without a Hook - Ricky Montgomery',
            '505 - Arctic Monkeys',
            'RUDE! - Hearts2Hearts'
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
        });

        function initializeApp() {
            simulateLoading();
            initializeTetris();
        }

        function simulateLoading() {
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            const loadingText = document.getElementById('loading-text');
            
            let progress = 0;
            const messages = [
                'INITIALIZING..._',
                'LOADING MEMORIES..._',
                'PREPARING SURPRISE..._',
                'ALMOST READY..._',
                'LOADING COMPLETE!_'
            ];
            
            const interval = setInterval(() => {
                progress += Math.floor(Math.random() * 10) + 5;
                if (progress > 100) progress = 100;
                
                progressFill.style.width = progress + '%';
                progressText.textContent = progress + '%';
                
                const msgIndex = Math.floor((progress / 100) * (messages.length - 1));
                loadingText.textContent = '> ' + messages[msgIndex];
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        showScreen('main');
                    }, 1000);
                }
            }, 200);
        }

        window.showScreen = function(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            const targetScreen = document.getElementById(screenId + '-screen');
            if (targetScreen) {
                targetScreen.classList.add('active');
                currentScreen = screenId;
                
                if (screenId === 'message') initializeMessage();
                if (screenId === 'gallery') initializeGallery();
                if (screenId === 'music') initializeMusic();
                if (screenId === 'tetris' && tetrisGame && !tetrisGame.gameRunning) {
                    startTetrisGame();
                }
            }
        };

        function setupEventListeners() {
            // Skip button
            document.getElementById('skip-btn')?.addEventListener('click', skipMessage);
            
            // Photo button
            document.getElementById('photo-btn')?.addEventListener('click', startPhotoShow);
            
            // Music controls
            document.getElementById('prev-btn')?.addEventListener('click', prevSong);
            document.getElementById('play-pause-btn')?.addEventListener('click', playPause);
            document.getElementById('next-btn')?.addEventListener('click', nextSong);
            
            // Song selection
            document.querySelectorAll('.song').forEach(song => {
                song.addEventListener('click', function() {
                    const index = parseInt(this.dataset.index);
                    playSong(index);
                });
            });
            
            // Tetris controls
            document.getElementById('left-btn')?.addEventListener('click', () => moveTetrisPiece(-1));
            document.getElementById('right-btn')?.addEventListener('click', () => moveTetrisPiece(1));
            document.getElementById('rotate-btn')?.addEventListener('click', rotateTetrisPiece);
            
            // Game over modal
            document.getElementById('game-over-ok')?.addEventListener('click', () => {
                document.getElementById('game-over-modal').classList.remove('active');
                showScreen('main');
            });
            
            // Final modal
            document.getElementById('final-ok')?.addEventListener('click', () => {
                document.getElementById('final-message-modal').classList.remove('active');
                showScreen('main');
            });
        }

        // Message functions
        function initializeMessage() {
            if (typewriterInterval) clearInterval(typewriterInterval);
            
            const messageContent = document.getElementById('message-content');
            if (!messageContent) return;
            
            messageContent.innerHTML = '';
            let charIndex = 0;
            isTyping = true;
            
            typewriterInterval = setInterval(() => {
                if (charIndex < fullMessage.length) {
                    const char = fullMessage[charIndex];
                    messageContent.innerHTML += char === '\n' ? '<br>' : char;
                    charIndex++;
                    messageContent.scrollTop = messageContent.scrollHeight;
                } else {
                    clearInterval(typewriterInterval);
                    isTyping = false;
                }
            }, 50);
        }

        function skipMessage() {
            if (isTyping && typewriterInterval) {
                clearInterval(typewriterInterval);
                const messageContent = document.getElementById('message-content');
                messageContent.innerHTML = fullMessage.replace(/\n/g, '<br>');
                isTyping = false;
            }
        }

        // Gallery functions
        function initializeGallery() {
            const photoDisplay = document.getElementById('photo-display');
            photoDisplay.innerHTML = '<div class="photo-placeholder">Press START PRINT to begin</div>';
            document.getElementById('photobox-progress').textContent = 'üì∏ READY TO PRINT';
            document.getElementById('photo-btn').disabled = false;
            document.getElementById('photo-btn').textContent = 'START PRINT';
            currentPhotoIndex = 0;
        }

        function startPhotoShow() {
            const photoBtn = document.getElementById('photo-btn');
            const photoDisplay = document.getElementById('photo-display');
            const progressDiv = document.getElementById('photobox-progress');
            
            photoBtn.disabled = true;
            photoBtn.textContent = 'PRINTING...';
            progressDiv.textContent = 'INITIALIZING CAMERA...';
            
            // Create frames with image placeholders
            let framesHTML = '';
            for (let i = 0; i < photos.length; i++) {
                framesHTML += `
                    <div class="photo-frame" id="frame-${i+1}">
                        <div class="photo-content" style="color:#333;">READY</div>
                    </div>
                `;
            }
            
            photoDisplay.innerHTML = `
                <div style="display:flex; flex-direction:column; width:100%;">
                    <div style="text-align:center; color:#9bbc0f; margin-bottom:5px; font-weight:bold;">PHOTOSTRIP SESSION</div>
                    <div style="max-height:250px; overflow-y:auto; padding:5px;">
                        ${framesHTML}
                    </div>
                    <div style="text-align:center; color:#9bbc0f; margin-top:5px; font-weight:bold;">üéÇ HAPPY BIRTHDAY! üéÇ</div>
                </div>
            `;
            
            currentPhotoIndex = 0;
            
            let countdown = 3;
            progressDiv.textContent = `GET READY... ${countdown}`;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    progressDiv.textContent = `GET READY... ${countdown}`;
                } else {
                    clearInterval(countdownInterval);
                    progressDiv.textContent = 'SMILE! üì∏';
                    startPhotoCapture();
                }
            }, 1000);
        }

        function startPhotoCapture() {
            const progressDiv = document.getElementById('photobox-progress');
            
            const captureInterval = setInterval(() => {
                if (currentPhotoIndex < photos.length) {
                    const frame = document.getElementById(`frame-${currentPhotoIndex + 1}`);
                    
                    if (frame) {
                        progressDiv.textContent = '‚ú® FLASH! ‚ú®';
                        
                        setTimeout(() => {
                            frame.classList.add('filled');
                            const photo = photos[currentPhotoIndex];
                            
                            // Create image element
                            const img = document.createElement('img');
                            img.src = photo.image;
                            img.alt = photo.text;
                            img.style.width = '100%';
                            img.style.height = '100%';
                            img.style.objectFit = 'cover';
                            
                            // Clear frame and add image
                            frame.innerHTML = '';
                            frame.appendChild(img);
                            
                            // Add text overlay
                            const overlay = document.createElement('div');
                            overlay.style.position = 'absolute';
                            overlay.style.bottom = '0';
                            overlay.style.left = '0';
                            overlay.style.right = '0';
                            overlay.style.background = 'rgba(0,0,0,0.7)';
                            overlay.style.color = 'white';
                            overlay.style.padding = '5px';
                            overlay.style.textAlign = 'center';
                            overlay.style.fontSize = '10px';
                            overlay.style.fontWeight = 'bold';
                            overlay.textContent = photo.text;
                            
                            frame.style.position = 'relative';
                            frame.appendChild(overlay);
                            
                            const displayCount = currentPhotoIndex + 1;
                            progressDiv.textContent = `CAPTURED ${displayCount}/${photos.length}`;
                            currentPhotoIndex++;
                        }, 500);
                    } else {
                        currentPhotoIndex++;
                    }
                } else {
                    clearInterval(captureInterval);
                    
                    setTimeout(() => {
                        progressDiv.textContent = 'üéâ PHOTO STRIP COMPLETE! üéâ';
                        document.getElementById('photo-btn').textContent = 'PRINT AGAIN';
                        document.getElementById('photo-btn').disabled = false;
                    }, 2000);
                }
            }, 1500);
        }

        // Music functions
        function initializeMusic() {
            updateNowPlaying();
            document.querySelectorAll('.song').forEach((song, index) => {
                if (index === currentSongIndex) {
                    song.classList.add('playing');
                } else {
                    song.classList.remove('playing');
                }
            });
        }

        function playSong(index) {
            if (index < 0 || index >= 5) return;
            
            currentSongIndex = index;
            updateNowPlaying();
            
            document.querySelectorAll('.song').forEach((song, i) => {
                if (i === currentSongIndex) {
                    song.classList.add('playing');
                } else {
                    song.classList.remove('playing');
                }
            });
            
            isPlaying = true;
            document.getElementById('play-pause-btn').textContent = '‚è∏';
        }

        function playPause() {
            isPlaying = !isPlaying;
            document.getElementById('play-pause-btn').textContent = isPlaying ? '‚è∏' : '‚èØ';
        }

        function prevSong() {
            let newIndex = currentSongIndex - 1;
            if (newIndex < 0) newIndex = 4;
            playSong(newIndex);
        }

        function nextSong() {
            let newIndex = currentSongIndex + 1;
            if (newIndex >= 5) newIndex = 0;
            playSong(newIndex);
        }

        function updateNowPlaying() {
            document.getElementById('now-playing').textContent = `üéú Now Playing: ${songTitles[currentSongIndex]}`;
        }

        // Tetris functions
        function initializeTetris() {
            tetrisGame = {
                board: Array(20).fill().map(() => Array(10).fill(0)),
                currentPiece: null,
                gameRunning: false
            };
        }

        function startTetrisGame() {
            tetrisGame.gameRunning = true;
            gameScore = 0;
            gameLevel = 1;
            gameLines = 0;
            updateTetrisStats();
            drawTetrisBoard();
            
            if (gameOverTimer) clearTimeout(gameOverTimer);
            gameOverTimer = setTimeout(() => {
                if (tetrisGame?.gameRunning) {
                    gameOver();
                }
            }, 10000);
        }

        function moveTetrisPiece(direction) {
            if (!tetrisGame?.gameRunning) return;
            console.log('Moving piece:', direction);
        }

        function rotateTetrisPiece() {
            if (!tetrisGame?.gameRunning) return;
            console.log('Rotating piece');
        }

        function updateTetrisStats() {
            document.getElementById('score').textContent = gameScore;
            document.getElementById('level').textContent = gameLevel;
            document.getElementById('lines').textContent = gameLines;
        }

        function drawTetrisBoard() {
            const canvas = document.getElementById('tetris-canvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = '#9bbc0f';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= 10; i++) {
                ctx.beginPath();
                ctx.moveTo(i * 30, 0);
                ctx.lineTo(i * 30, canvas.height);
                ctx.stroke();
            }
            
            for (let i = 0; i <= 20; i++) {
                ctx.beginPath();
                ctx.moveTo(0, i * 20);
                ctx.lineTo(canvas.width, i * 20);
                ctx.stroke();
            }
        }

        function gameOver() {
            tetrisGame.gameRunning = false;
            clearTimeout(gameOverTimer);
            
            document.getElementById('game-over-modal').classList.add('active');
            
            document.getElementById('game-over-ok').onclick = () => {
                document.getElementById('game-over-modal').classList.remove('active');
                document.getElementById('final-message-modal').classList.add('active');
            };
        }
    </script>
</body>
    </html>
